<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phase 4 Mermaid Architecture Test</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 40px;
            background-color: #f5f5f5;
        }
        .diagram-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        h1, h2 {
            color: #333;
        }
        .mermaid {
            text-align: center;
        }
    </style>
</head>
<body>
    <h1>🧜‍♀️ Phase 4 Mermaid Architecture Test</h1>
    <p>This page demonstrates the Mermaid diagrams from the Phase 4 architecture documentation.</p>

    <div class="diagram-container">
        <h2>1. System Architecture Overview</h2>
        <div class="mermaid">
graph TB
    subgraph "Audio Input Sources"
        IM["🎤 Internal Mic<br/>(Raw/Calibrated)"]
        EM["🎙️ External Mic<br/>(Raw/Calibrated)"]
        LI["🔌 Audio Line Input<br/>(Analog)"]
        USB["🎛️ USB Interface<br/>(Professional)"]
    end
    
    subgraph "AudioInputManager"
        DS["🔍 Detection System<br/>• Device Enumeration<br/>• Classification<br/>• Capabilities"]
        CE["⚙️ Calibration Engine<br/>• Frequency Response<br/>• Sensitivity<br/>• Noise Floor"]
        SP["📡 Stream Processing<br/>• Low Latency<br/>• High Quality<br/>• Multi-Channel"]
    end
    
    subgraph "Triple-Path Analysis"
        REF["📊 Reference Path<br/>(Digital)"]
        SIM["🔄 Simulation Path<br/>(Processed)"]
        REAL["🌍 Reality Path<br/>(Measured)"]
    end
    
    IM --> DS
    EM --> DS
    LI --> DS
    USB --> DS
    
    DS --> CE
    CE --> SP
    
    SP --> REF
    SP --> SIM
    SP --> REAL
    
    style IM fill:#e1f5fe
    style EM fill:#e1f5fe
    style LI fill:#e8f5e8
    style USB fill:#fff3e0
    style REF fill:#f3e5f5
    style SIM fill:#e8f5e8
    style REAL fill:#fff8e1
        </div>
    </div>

    <div class="diagram-container">
        <h2>2. Signal Flow Architecture</h2>
        <div class="mermaid">
flowchart TD
    subgraph "Input Sources"
        REF2["📊 Reference Signals<br/>(Digital)"]
        MIC["🎤 Microphone Input<br/>(Analog)"]
        USB2["🎛️ USB Interface<br/>(Professional)"]
    end
    
    subgraph "Processing Layer"
        subgraph "Speaker Processing"
            DN["🔄 DelayNode Chain<br/>• A_left<br/>• A_right<br/>• B_left<br/>• B_right"]
            CF["🌊 Comb Filter<br/>• Dry Path<br/>• Wet Path"]
            DN --> CF
        end
        
        subgraph "Input Processing"
            CAL["⚙️ Calibration<br/>• Freq Correction<br/>• Sensitivity<br/>• Noise Filter"]
        end
    end
    
    subgraph "Analysis Engine"
        AR["📈 analyzers.reference<br/>(Raw Digital)"]
        AI["📊 analyzers.input<br/>(Processed Digital)"]
        AC["🎯 analyzers.calibrated<br/>(Real Measurement)"]
    end
    
    subgraph "Educational Output"
        TVR["🤔 Theory vs Reality"]
        SV["✅ Simulation Validation"]
        RC["🏠 Room Characterization"]
        PM["📊 Professional Metrics"]
    end
    
    REF2 --> DN
    MIC --> CAL
    USB2 --> CAL
    
    REF2 --> AR
    CF --> AI
    CAL --> AC
    
    AR --> TVR
    AI --> SV
    AC --> RC
    
    TVR --> PM
    SV --> PM
    RC --> PM
    
    style REF2 fill:#e3f2fd
    style MIC fill:#f3e5f5
    style USB2 fill:#fff3e0
    style DN fill:#e8f5e8
    style CF fill:#e8f5e8
    style CAL fill:#fff8e1
    style AR fill:#e1f5fe
    style AI fill:#e8f5e8
    style AC fill:#fff3e0
        </div>
    </div>

    <div class="diagram-container">
        <h2>3. Performance Metrics</h2>
        <div class="mermaid">
graph TB
    subgraph "Performance Metrics Dashboard"
        subgraph "Audio Quality"
            AQ1["⚡ Latency < 50ms"]
            AQ2["📡 SNR > 60dB"]
            AQ3["🎯 THD+N < 0.1%"]
            AQ4["📊 Dynamic Range > 90dB"]
        end
        
        subgraph "System Performance"
            SP1["💻 CPU < 10%"]
            SP2["🧠 RAM < 500MB"]
            SP3["🎵 Real-time 48kHz"]
            SP4["⏱️ Stable Operation > 1hr"]
        end
        
        subgraph "Accuracy"
            AC1["🎛️ Calibration ±2dB"]
            AC2["🎼 Frequency ±1Hz"]
            AC3["⏲️ Time ±0.1ms"]
            AC4["🔄 Phase ±5°"]
        end
    end
    
    style AQ1 fill:#e8f5e8
    style AQ2 fill:#e8f5e8
    style AQ3 fill:#e8f5e8
    style AQ4 fill:#e8f5e8
    style SP1 fill:#e3f2fd
    style SP2 fill:#e3f2fd
    style SP3 fill:#e3f2fd
    style SP4 fill:#e3f2fd
    style AC1 fill:#fff3e0
    style AC2 fill:#fff3e0
    style AC3 fill:#fff3e0
    style AC4 fill:#fff3e0
        </div>
    </div>

    <script>
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            securityLevel: 'loose',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            }
        });
    </script>

    <footer style="margin-top: 50px; text-align: center; color: #666;">
        <p>🧜‍♀️ Powered by Mermaid.js | Qualia-NSS Phase 4 Architecture</p>
    </footer>
</body>
</html>