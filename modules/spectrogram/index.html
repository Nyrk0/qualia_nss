<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Spectrogram</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <h1>Spectrogram</h1>
    <nav class="links">
      <a href="../7band-level-meter/index.html">7â€‘Band Level Meter</a>
      <a href="../spectrum-analyzer/index.html">Spectrum Analyzer</a>
      <a class="ref" href="../docs/spectrogram/spectrogram-nss-prd.md" target="_blank">PRD</a>
    </nav>
  </header>

  <section class="controls">
    <div class="control-group">
      <strong class="group-label">Source</strong>
      <button id="micToggle" title="Start/Stop Microphone">ðŸŽ¤ Mic</button>
      <select id="deviceSelect" title="Select Input Device"></select>
      <label for="gainDb" title="Input Gain / Calibration Offset">Gain:</label>
      <input id="gainDb" type="number" value="0" min="-20" max="20" step="1" class="db-input">
    </div>

    <div class="control-group">
      <strong class="group-label">Analysis</strong>
      <label for="fftSize">FFT:</label>
      <select id="fftSize" title="FFT Size">
        <option>2048</option>
        <option>4096</option>
        <option selected>8192</option>
        <option>16384</option>
      </select>
      <label for="windowFunc">Window:</label>
      <select id="windowFunc" title="Windowing Function">
        <option value="hann" selected>Hann</option>
        <option value="hamming">Hamming</option>
        <option value="rectangular">Rectangular</option>
      </select>
      <label for="timeBtn">Time:</label>
      <button id="timeBtn" class="time-btn" data-time="10" title="Time Window (5s/10s/15s)">ðŸ•’ 10s</button>
    </div>

    <div class="control-group">
      <strong class="group-label">Display</strong>
      <button id="viewToggle" title="Toggle 2D/3D View">ðŸ§Š 3D</button>
      <label for="colormap">Map:</label>
      <select id="colormap" title="Colormap">
        <option value="musiclab" selected>MusicLab</option>
        <option value="inferno">Inferno</option>
        <option value="viridis">Viridis</option>
        <option value="magma">Magma</option>
        <option value="plasma">Plasma</option>
        <option value="cividis">Cividis</option>
      </select>
      <label for="floorDb">Range (dB):</label>
      <input id="floorDb" type="number" value="-100" min="-140" max="-20" step="1" title="dB Floor" class="db-input">
      <input id="ceilDb" type="number" value="-20" min="-60" max="20" step="1" title="dB Ceiling" class="db-input">
      <label class="toggle" title="Show 7-band frequency guides">
        <input id="overlayBands" type="checkbox" checked />
        Guides
      </label>
    </div>

    <div class="control-group">
      <strong class="group-label">Generators</strong>
      <button id="noiseWhiteBtn" title="Play White Noise">White</button>
      <button id="noisePinkBtn" title="Play Pink Noise">Pink</button>
      <button id="noiseBrownBtn" title="Play Brown Noise">Brown</button>
    </div>

    <div class="control-group">
      <button id="snapshotBtn" title="Save as PNG">Snapshot ðŸ“¸</button>
    </div>
  </section>

  <main class="main-content">
    <div class="canvas-wrap">
      <canvas id="spec2d" width="1024" height="512"></canvas>
      <canvas id="overlay" width="1024" height="512"></canvas>
      <canvas id="spec3d" width="1024" height="512" style="display: none;"></canvas>
    </div>

    <aside class="right-sidebar">
      <div class="legend">
        <div class="scale">
          <canvas id="scaleCanvas" width="20" height="256" title="Intensity scale"></canvas>
          <div class="labels" id="scaleLabels">
            <span>-20 dB</span>
            <span>-60</span>
            <span>-100 dB</span>
          </div>
        </div>
        <div class="readout" id="readout">-- Hz | -- dBFS | -- s</div>
      </div>

      <div id="piano" class="piano-container">
        <!-- Piano keys will be generated by JavaScript -->
      </div>
    </aside>
  </main>

  <script src="script.js"></script>
</body>
</html>
