/**
 * Wiki Module - Styling for dynamic documentation system
 * Part of the Qualia-NSS modular CSS architecture
 * COMPLIANT with UI/UX Development Directive v1.0
 * @author Qualia-NSS Development Team
 * @version 3.0.0
 */

/* Wiki Accordion Links - Override default accordion body styling for wiki links */
.wiki-link {
    display: block;
    padding: var(--spacing-sm) var(--spacing-md);
    color: var(--neutral-text-color);
    text-decoration: none;
    font-size: var(--font-size-sm);
    transition: all 0.2s ease;
    border-left: 3px solid transparent;
}

.wiki-link:hover {
    background-color: var(--primary-color-translucent);
    color: var(--primary-color);
    text-decoration: none;
    border-left-color: var(--primary-color);
}

.wiki-link.active {
    background-color: var(--primary-color);
    color: white;
    border-left-color: var(--primary-color-hover);
    font-weight: 500;
}

/* Hierarchical TOC Styling - Like GitHub Wiki */
.wiki-heading-item {
    border-bottom: none !important;
    margin-bottom: 2px;
}

.wiki-heading-item .wiki-link {
    padding: var(--spacing-xs) var(--spacing-sm) var(--spacing-xs) var(--spacing-md);
    font-size: var(--font-size-xs);
    color: var(--muted-text-color);
    border-left: 2px solid transparent;
    background: transparent;
}

.wiki-heading-item .wiki-link:hover {
    background-color: var(--primary-color-translucent, rgba(40, 167, 69, 0.1));
    color: var(--primary-color);
    border-left-color: var(--primary-color);
}

.wiki-heading-item .wiki-link.active {
    background-color: var(--primary-color);
    color: white;
    border-left-color: var(--primary-color-hover);
}

/* Different styling for heading links vs document links */
.wiki-heading-link small {
    font-size: var(--font-size-xs);
    opacity: 0.9;
}

/* Hierarchical TOC Level Styling - DOM-based approach */
.toc-level-1 {
    font-weight: 600;
    color: var(--primary-color) !important;
    border-left: 3px solid var(--primary-color) !important;
}

.toc-level-2 {
    font-weight: 500;
    color: var(--text-color) !important;
    border-left: 2px solid var(--muted-text-color) !important;
}

.toc-level-3 {
    font-weight: normal;
    color: var(--neutral-text-color) !important;
    border-left: 1px solid var(--panel-border-color) !important;
}

.toc-level-4 {
    font-weight: normal;
    color: var(--muted-text-color) !important;
    font-style: italic;
    border-left: 1px dotted var(--panel-border-color) !important;
}

/* Enhanced hover states for TOC levels */
.toc-level-1:hover {
    background-color: var(--primary-color-translucent) !important;
    color: var(--primary-color-hover) !important;
}

.toc-level-2:hover,
.toc-level-3:hover,
.toc-level-4:hover {
    background-color: var(--primary-color-translucent) !important;
    color: var(--primary-color) !important;
}

/* Active state for heading links */
.wiki-heading-link.active {
    background-color: var(--primary-color) !important;
    color: white !important;
    font-weight: 600;
}

.wiki-heading-link.active small {
    color: white !important;
}

/* Ensure hierarchical indentation is visible */
.wiki-heading-item[style*="margin-left"] .wiki-link {
    position: relative;
}

/* Add subtle background for nested items */
.wiki-heading-item[style*="margin-left: 20px"] .wiki-link {
    background-color: var(--panel-bg-color);
}

.wiki-heading-item[style*="margin-left: 40px"] .wiki-link {
    background-color: var(--panel-bg-color);
}

/* Override form-check styling for wiki links */
#sidebarAccordion .form-check {
    margin: 0;
    padding: 0;
    border-bottom: 1px solid var(--panel-border-color);
}

#sidebarAccordion .form-check:last-child {
    border-bottom: none;
}

/* Wiki Content Area Styling - COMPLIANT with UI/UX Directive */
#wiki-content-container {
    padding: 0;
    background-color: var(--bg-color);
    min-height: 400px;
    flex: 1 1 auto; /* Take up available space in flex container */
    overflow-y: auto; /* Allow scrolling when content exceeds container height */
    overflow-x: hidden; /* Prevent horizontal scrolling */
    scrollbar-width: none; /* Firefox - hide scrollbar */
    -ms-overflow-style: none; /* IE/Edge - hide scrollbar */
}

/* Hide ALL scrollbars for Chrome/Safari/WebKit browsers */
#wiki-content-container::-webkit-scrollbar {
    display: none !important;
    width: 0 !important;
    height: 0 !important;
    background: transparent !important;
}

#wiki-content-container::-webkit-scrollbar-track {
    display: none !important;
}

#wiki-content-container::-webkit-scrollbar-thumb {
    display: none !important;
}

/* Wiki Breadcrumb - Using theme variables only */
.wiki-breadcrumb {
    padding: var(--spacing-md) var(--spacing-lg) 0;
    background-color: var(--panel-bg-color);
    border-bottom: 1px solid var(--panel-border-color);
}

.wiki-breadcrumb .breadcrumb {
    background: transparent;
    padding: var(--spacing-sm) 0;
    margin: 0;
    font-size: var(--font-size-sm);
}

.wiki-breadcrumb .breadcrumb-item {
    color: var(--muted-text-color);
}

.wiki-breadcrumb .breadcrumb-item.active {
    color: var(--text-color);
    font-weight: 500;
}

.wiki-breadcrumb .breadcrumb-item + .breadcrumb-item::before {
    color: var(--muted-text-color);
    content: "â€º";
}

/* Wiki Content - Following semantic hierarchy H1>H2>H3 as per directive */
.wiki-content {
    padding: var(--spacing-lg);
    max-width: none;
    width: 100%;
    margin: 0;
    line-height: 1.6;
}

/* H1: Primary page title (per directive section 3.2) */
.wiki-content h1 {
    font-size: var(--font-size-lg);
    color: var(--primary-color);
    border-bottom: 2px solid var(--primary-color);
    padding-bottom: var(--spacing-sm);
    margin: 0 0 calc(2 * var(--spacing-lg)) 0;
    font-weight: 600;
}

/* H2: Secondary headings (per directive section 3.2) */
.wiki-content h2 {
    font-size: var(--font-size-md);
    color: var(--text-color);
    border-bottom: 1px solid var(--panel-border-color);
    padding-bottom: var(--spacing-xs);
    margin: calc(2 * var(--spacing-lg)) 0 var(--spacing-md) 0;
    font-weight: 600;
}

/* H3: Tertiary headings (per directive section 3.2) */
.wiki-content h3 {
    font-size: var(--font-size-sm);
    color: var(--primary-color);
    margin: var(--spacing-lg) 0 var(--spacing-md) 0;
    font-weight: 600;
}

.wiki-content h4,
.wiki-content h5,
.wiki-content h6 {
    color: var(--text-color);
    margin: var(--spacing-lg) 0 var(--spacing-md) 0;
    font-weight: 600;
}

.wiki-content p {
    margin-bottom: var(--spacing-md);
    color: var(--neutral-text-color);
}

.wiki-content ul,
.wiki-content ol {
    margin-bottom: var(--spacing-md);
    padding-left: calc(2 * var(--spacing-md));
    color: var(--neutral-text-color);
}

.wiki-content li {
    margin-bottom: var(--spacing-sm);
}

.wiki-content blockquote {
    border-left: 4px solid var(--primary-color);
    margin: var(--spacing-lg) 0;
    padding: var(--spacing-sm) var(--spacing-md);
    background-color: var(--panel-bg-color);
    font-style: italic;
    color: var(--muted-text-color);
}

/* Code Styling - Using theme variables only */
.wiki-content code {
    background-color: var(--panel-bg-color);
    color: var(--primary-color);
    padding: var(--spacing-xs) var(--spacing-sm);
    border-radius: var(--spacing-xs);
    font-size: var(--font-size-sm);
    font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
}

.wiki-content pre {
    background-color: var(--panel-bg-color);
    color: var(--text-color);
    padding: var(--spacing-md);
    border-radius: var(--spacing-sm);
    overflow-x: auto;
    margin: var(--spacing-md) 0;
    border: 1px solid var(--panel-border-color);
}

.wiki-content pre code {
    background: transparent;
    color: inherit;
    padding: 0;
    border-radius: 0;
}

/* Tables - Using theme variables only */
.wiki-content table {
    width: 100%;
    border-collapse: collapse;
    margin: var(--spacing-md) 0;
    background-color: var(--panel-bg-color);
    border-radius: var(--spacing-sm);
    overflow: hidden;
    border: 1px solid var(--panel-border-color);
}

.wiki-content th,
.wiki-content td {
    padding: var(--spacing-sm);
    text-align: left;
    border-bottom: 1px solid var(--panel-border-color);
}

.wiki-content th {
    background-color: var(--primary-color);
    color: white;
    font-weight: 600;
}

.wiki-content tr:last-child td {
    border-bottom: none;
}

.wiki-content tr:hover {
    background-color: var(--primary-color-translucent);
}

/* Links - Using theme variables only */
.wiki-content a {
    color: var(--primary-color);
    text-decoration: none;
    border-bottom: 1px dotted var(--primary-color);
    transition: all 0.2s ease;
}

.wiki-content a:hover {
    color: var(--primary-color-hover);
    border-bottom: 1px solid var(--primary-color-hover);
    text-decoration: none;
}

/* Images - Using theme variables only */
.wiki-content img {
    max-width: 100%;
    height: auto;
    border-radius: var(--spacing-sm);
    margin: var(--spacing-md) 0;
    box-shadow: none;
}

/* Minimalist Sidebar TOC: remove shadows, flatten backgrounds */
#sidebarAccordion,
#sidebarAccordion .accordion-item,
#sidebarAccordion .accordion-button,
#sidebarAccordion .accordion-collapse,
#sidebarAccordion .accordion-body {
    box-shadow: none !important;
    background: transparent;
}

/* Minimize borders to hairlines */
#sidebarAccordion .accordion-item,
#sidebarAccordion .form-check {
    border: none;
}

/* Minimalist wiki links */
.wiki-link {
    border-left: 2px solid transparent;
}
.wiki-link:hover {
    background: transparent;
    color: var(--primary-color);
    border-left-color: var(--primary-color);
}
.wiki-link.active {
    background: transparent;
    color: var(--primary-color);
    border-left-color: var(--primary-color);
}

/* Loading State - Using theme variables only */
.wiki-loading {
    text-align: center;
    padding: calc(4 * var(--spacing-lg)) calc(2 * var(--spacing-lg));
    color: var(--muted-text-color);
}

.wiki-loading .spinner-border {
    color: var(--primary-color);
}

/* Markdown Fallback - Using theme variables only */
.markdown-fallback {
    padding: calc(2 * var(--spacing-lg));
}

.markdown-source {
    background-color: var(--panel-bg-color);
    border: 1px solid var(--panel-border-color);
    padding: var(--spacing-md);
    border-radius: var(--spacing-sm);
    font-family: 'Monaco', 'Menlo', 'Consolas', monospace;
    font-size: var(--font-size-sm);
    line-height: 1.4;
    color: var(--text-color);
    white-space: pre-wrap;
    overflow-x: auto;
}

/* Error State - Using theme variables only */
.wiki-content .alert {
    margin: calc(2 * var(--spacing-lg)) 0;
}

/* Responsive Design - Using theme variables only */
@media (max-width: 768px) {
    .wiki-content {
        padding: var(--spacing-md);
    }
    
    .wiki-breadcrumb {
        padding: var(--spacing-sm) var(--spacing-md) 0;
    }
    
    .wiki-link {
        padding: var(--spacing-xs) var(--spacing-sm);
        font-size: var(--font-size-xs);
    }
}

/* Light Theme Adjustments - NO hardcoded values, use theme variables */
body.light-theme .wiki-content code {
    background-color: var(--panel-bg-color);
    color: var(--primary-color);
}

body.light-theme .wiki-content pre {
    background-color: var(--panel-bg-color);
    border-color: var(--panel-border-color);
}

body.light-theme .wiki-content blockquote {
    background-color: var(--panel-bg-color);
}